---
sidebar: sidebar
permalink: rp-use-protect.html
keywords: ransomware protection, protect against ransomware attacks, anti-ransomware policies, detection, protection, policy, malware
summary: You can protect workloads against ransomware attacks by assigning policies to a workload in NetApp Ransomware Resilience.
---
= Protect workloads with NetApp Ransomware Resilience protection strategies
:hardbreaks:
:icons: font
:imagesdir: ./media/

[.lead]
You can protect workloads against ransomware attacks by enabling workload-consistent protection or creating ransomware protection strategies in NetApp Ransomware Resilience. 

include::_include/console-role-admin.adoc[]

== Understand ransomware protection strategies [[strategy]]
// check term with PM

Ransomware protection strategies encompass _detection_, _protection_, and _replication_ policies.

- **Detection policies** identify ransomware threats 

- **Protection policies** include snapshot and backup policies. Detection and snapshot policies are required in a protection strategy. Backup policies are optional.
+
If you're using other NetApp products to protect your workload, Ransomware Resilience discovers those and provides the option to either:
+
* use a ransomware detection policy and continue to use the snapshot and backup policies created by other NetApp tools, or
+
* use Ransomware Resilience to manage detection, snapshots, and backups.

- **Replication policies** enable you to replicate snapshots from Ransomware Resilience to a secondary site. Replication schedules can be set to hourly, daily, weekly, or monthly frequencies. 
+
Currently, you can only replicate snapshots to on-premises ONTAP storage.

[NOTE]
If you're configuring protection strategies for Amazon FSxN for ONTAP and Azure NetApp Files, consult link:rp-reference-limitations.html[the limitations for each service].

[TIP]
For enhanced management and protection of your data estate, you can create link:task-protection-group.html[group workloads] to collectively protect volumes under one strategy. 

=== Protection policies with other NetApp-managed services [[services]]

Beyond Ransomware Resilience, you can use NetApp Backup and Recovery to manage protection for file shares, VM file shares.

Protection information from Backup & Recovery services appears in Ransomware Resilience. You can add detection policies to these services with Ransomware Resilience. Adding a protection policy with Ransomware Resilience replaces the existing protection policies. 

Ransomware Resilience also discovers protection policies from SnapCenter for VMware for VM datastores and SnapCenter for Oracle. You can't use these services to restore with Ransomware Resilience.

If a ransomware detection policy is being managed by Autonomous Ransomware Protection (ARP or ARP/AI, depending on the ONTAP version) and FPolicy in ONTAP, those workloads are protected and will continue to be managed by ARP and FPolicy. 

NOTE: Backup destinations are not available for workloads in Amazon FSx for NetApp ONTAP or Azure NetApp Files. Perform backup operations using the FSx for ONTAP backup service. You set backup policies for workloads in FSx for ONTAP in AWS, not in Ransomware Resilience. The backup policies appear in Ransomware Resilience and remain unchanged from AWS. 

=== Protection policies for workloads not protected by NetApp applications

If your workload isn't managed by Backup and Recovery or Ransomware Resilience, it may have snapshots taken as part of ONTAP or other products. If ONTAP FPolicy protection is in place, you can change the FPolicy protection using ONTAP. 
 
== View ransomware protection on a workload

One of the first steps in protecting workloads is viewing your current workloads and their protection status. You can see the following types of workloads: 

* Application workloads 
* Block workloads
* File share workloads
* VM workloads

.Steps 

. From the Console's left navigation, select *Protection* > *Ransomware Resilience*. 
. Do one of the following: 
+
* From the Data Protection pane on the Dashboard, select *View all*. 
* From the menu, select *Protection*.
+
image:screen-protection.png[Protection page]
. From this page, you can view and change protection details for the workload.

NOTE: See link:#add-a-ransomware-protection-strategy[Add a ransomware protection strategy] to learn about using Ransomware Resilience when there's an existing protection policy with Backup and Recovery.

=== Understand the Protection page

The Protection page shows the following information about workload protection: 

*Protection status*: A workload can show one of the following protection statuses to indicate whether a policy is applied or not: 

* *Protected*: A policy is applied. ARP (or ARP/AI depending on the ONTAP version) is enabled on all volumes related to the workload. 
* *At risk*: No policy is applied. If a workload does not have a primary detection policy enabled, it is "at risk" even if it has a snapshot and backup policy enabled. 
* *In progress*: A policy is being applied but not completed yet. 
* *Failed*: A policy is applied but is not working. 

//*Protection health*: A workload can have one of the following protection health statuses: 

//* *Healthy*: The workload has protection enabled and backups and snapshot copies have been completed. 
//* *In progress*: Backups or snapshot copies are in progress. 
//* *Failed*: Backups or snapshot copies have not completed successfully. 
//* *N/A*: Protection is not enabled or sufficient on the workload. 

*Detection status*: A workload can have one of the following ransomware detection statuses: 

* *Learning*: A ransomware detection policy was recently assigned to the workload and Ransomware Resilience is scanning workloads. 
* *Active*: A ransomware detection protection policy is assigned. 
* *Not set*: A ransomware detection protection policy is not assigned. 
* *Error*: A ransomware detection policy was assigned, but Ransomware Resilience has encountered an error. 
+
TIP: When protection is enabled in Ransomware Resilience, alert detection and reporting begins after the ransomware detection policy status changes from Learning mode to Active mode.

[NOTE]
Suspicious user behavior activity and FPolicy (suspicious file extension) activity are listed separately from detection status. 

*Detection policy*: The name of the ransomware detection policy appears, if one has been assigned. If the detection policy has not been assigned, "N/A" appears. 

*Replication destination*: If you've configured snapshot replication, the names of the destination storage VMs and systems are listed. If there's no replication, this field displays "None."

*Snapshot, replication, and backup policies*: This column shows the snapshot and backup policies applied to the workload and the product or service that is managing those policies.  

* Managed by SnapCenter
* Managed by SnapCenter Plug-in for VMware vSphere
* Managed by Backup and Recovery
* Name of ransomware protection policy that governs snapshots and backups
* None

[NOTE]
You can't managed recovery in Ransomware Resilience for any SnapCenter policies.

*Workload importance*

Ransomware Resilience assigns an importance or priority to each workload during discovery based on an analysis of each workload. The workload importance is determined by the following snapshot frequencies: 

* *Critical*: More than one snapshot copy is taken per hour (highly aggressive protection schedule)
* *Important*: Snapshots copies are created less frequently than every hour but more frequently than every day 
* *Standard*: Snapshot copies are taken more than once per day

=== Predefined detection policies [[predefined]]

You can choose one of the following Ransomware Resilience predefined policies, which are aligned with workload importance. 

[NOTE]
The **Encryption user extension** policy is the only predefined policy that supports suspicious user behavior detection. 
+
The **Critical replication policy** is the  only predefined policy that supports replicating snapshots to ONTAP. 

[cols=6*,options="header",cols="10,15a,20,15,15,15" width="100%"]
|===
| Policy level
| Snapshot
| Frequency
| Retention (days)
| Number of snapshot copies
| Maximum number of snapshot copies

.4+| *Critical workload policy* | Quarter hourly | Every 15 min | 3 | 288 | 309 
 | Daily  | Every 1 day | 14 | 14 | 309 
 | Weekly | Every 1 week | 35 | 5 | 309 
 | Monthly | Every 30 days | 60 | 2 | 309 

.4+| *Important workload policy* | Quarter hourly | Every 30 mins | 3 | 144 | 165 
 | Daily | Every 1 day | 14 | 14 | 165 
 | Weekly | Every 1 week | 35 | 5 | 165 
 | Monthly | Every 30 days | 60 | 2 | 165 


.4+| *Standard workload policy* | Quarter hourly | Every 30 min | 3| 72 | 93 
 | Daily | Every 1 day | 14 | 14 | 93  
 | Weekly | Every 1 week | 35 | 5  | 93 
 | Monthly | Every 30 days | 60 | 2 | 93 

.4+| *Encryption user extension* | Quarter hourly | Every 30 min | 3| 72 | 93 
 | Daily | Every 1 day | 14 | 14 | 93  
 | Weekly | Every 1 week | 35 | 5  | 93 
 | Monthly | Every 30 days | 60 | 2 | 93

 .4+| *Critical replication policy* | Quarter hourly | Every 15 min | 3 | 288 | 309 
 | Daily  | Every 1 day | 14 | 14 | 309 
 | Weekly | Every 1 week | 35 | 5 | 309 
 | Monthly | Every 30 days | 60 | 2 | 309 

|===

== Add a ransomware protection strategy

There are three approaches to adding a ransomware protection strategy: 

* **Create a ransomware protection strategy if you have no snapshot or backup policies.**
+
The ransomware protection strategy includes:

** Snapshot policy 
** Ransomware detection policy
** Backup policy

*  **Replace the existing snapshot or backup policies from Backup and Recovery protection with protection strategies managed by Ransomware Resilience.**
+
The ransomware protection strategy includes:

** Snapshot policy 
** Ransomware detection policy
** Backup policy 

* *Create a detection policy for workloads with existing snapshot and backup policies managed in other NetApp products or services.*
+
The detection policy does not change the policies managed in other products.
+
The detection policy enables Autonomous Ransomware Protection and FPolicy protection if they are already activated in other services. Learn more about link:https://docs.netapp.com/us-en/ontap/anti-ransomware/index.html[Autonomous Ransomware Protection^], link:https://docs.netapp.com/us-en/data-services-backup-recovery/index.html[Backup and Recovery^], and link:https://docs.netapp.com/us-en/ontap/nas-audit/two-parts-fpolicy-solution-concept.html[ONTAP FPolicy^].

=== Create a ransomware protection strategy (if you have no snapshot or backup policies)

If snapshot or backup policies do not exist on the workload, you can create a ransomware protection strategy, which can include the following policies that you create in Ransomware Resilience: 

* Snapshot policy 
* Backup policy 
* Ransomware detection policy
* Secondary replication to ONTAP

.Steps to create a ransomware protection strategy [[steps]]

. From the Ransomware Resilience menu, select *Protection*.
+
image:screen-protection.png[Manage strategy page]

. From the Protection page, select a workload then *Protect*. 

. From the Ransomware protection strategies page, select *Add*. 
+
image:screen-protection-strategy-add.png[Add strategy page showing the snapshot section]

. Enter a new strategy name, or enter an existing name to copy it. If you enter an existing name, choose which one to copy and select *Copy*.
+
NOTE: If you choose to copy and modify an existing strategy, Ransomware Resilience appends "_copy" to the original name. You should change the name and at least one setting to make it unique. 

. For each item, select the *Down arrow*. 

* *Detection policy*: 
** *Policy*: Choose one of the predesigned detection policies. 
** *Primary detection*: Enable Ransomware Resilience to detect potential ransomware attacks. 
** *Suspicious user behavior detection*: Enable user behavior detection to transmit user activity events to Ransomware Resilience and detect suspicious events, such as data breaches. 
** *Block file extensions*: Enable Ransomware Resilience to block known suspicious file extensions. Ransomware Resilience takes automated snapshot copies when Primary detection is enabled. 
+
If you want to change the blocked file extensions, edit them in System Manager. 

* *Snapshot policy*: 
** *Snapshot policy base name*: Select a policy or select *Create* and enter a name for the snapshot policy. 
** *Snapshot locking*: Enable this to lock the snapshot copies on primary storage so that they cannot be modified or deleted for a certain period of time even if a ransomware attack manages its way to the backup storage destination. This is also called _immutable storage_. This enables quicker restore time. 
+
When a snapshot is locked, the volume expiration time is set to the expiration time of the snapshot copy. 
+
Snapshot copy locking is available with ONTAP 9.12.1 and later. To learn more about SnapLock, refer to https://docs.netapp.com/us-en/ontap/snaplock/index.html[SnapLock in ONTAP^].
** *Snapshot schedules*: Choose schedule options, the number of snapshot copies to keep, and select to enable the schedule. 
//+
//image:screen-protection-strategy-add-backups.png[Add strategy page showing the Backup section]
* *Replication policy*:
** *Replication policy basename*: Enter a new name or choose an existing one. The basename is the prefix appended to all snapshots. 
** *Replication schedules*: Toggle the frequencies you want to enable (hourly, daily, weekly, or monthly) and set the retention value (the number of replicated snapshots to keep) for each schedule you enable. 

* *Backup policy*: 
** *Backup policy basename*: Enter a new or choose an existing name. 
//** *Backup locking*: Choose this to prevent backups on secondary storage from being modified or deleted for a certain period of time. This is also called _immutable storage_. 

** *Backup schedules*: Choose schedule options for secondary storage and enable the schedule. 
+
TIP: To enable backup locking on secondary storage, configure your backup destinations using the *Settings* option. For details, see link:rp-use-settings.html[Configure settings].

. Select *Add*. 

=== Add a detection policy to workloads with existing snapshot and backup policies managed by Backup and Recovery

Ransomware Resilience enables you to assign either a detection policy or a protection policy to workloads with existing snapshot and backup protection managed in other NetApp products or services. Backup and Recovery uses policies that govern snapshots, replication to secondary storage, or backups to object storage. 

==== Add a detection policy to workloads with existing backup or snapshot policies

If you have existing snapshot or backup policies with Backup and Recovery, you can add a policy to detect ransomware attacks. To manage protection and detection with Ransomware Resilience, see <<protection, Protect with Ransomware Resilience>>.

.Steps
. From the Ransomware Resilience menu, select *Protection*.
+
image:screen-protection.png[Manage strategy page]

. From the Protection page, select a workload then select *Protect*. 
. Ransomware Resilience detects if there are existing active Backup and Recovery policies.
. To leave your existing Backup and Recovery in place and only apply a _detection_ policy, leave the **Replace existing policies** box unchecked.
. Select the detection settings you want:
+
    *Encryption detection*
    *Suspicious user behavior detection*
    *Block suspicious file extensions* 
+
. Select **Next**.
. If you selected *Suspicious user behavior detection* as a detection setting, select the User activity agent or link:suspicious-user-activity.html#create-a-user-activity-agent[or create one].
+ 
The user activity agent hosts the new data collectors. Ransomware Resilience creates the data collector automatically to transmit user activity events to Ransomware Resilience to detect anomalous user behavior.
. Select **Next**.
. Review your choices. Select **Create** to activate detection. 
. On the Protection page, review the **Detection status** to confirm detection is Active.  

==== Replace existing backup or snapshot policies with a ransomware protection strategy [[protection]]

You can replace your existing backup or snapshot policies with a ransomware protection strategy. This approach removes your externally managed protection and configures detection and protection in Ransomware Resilience. 

.Steps

. From the Ransomware Resilience menu, select *Protection*.
+
image:screen-protection.png[Manage strategy page]

. From the Protection page, select a workload then select *Protect*. 
. Ransomware Resilience detects if there are existing active Backup and Recovery policies. To replace the existing policies, select the **Replace existing policies** box. When you select the box, Ransomware Resilience replaces the list of detection policies with detection policies. 

. Choose a protection policy. If no protection policy exists, select **Add** to create a new policy. For information about creating a policy, see <<steps, Create a protection policy>>. Select **Next**. 
. If your strategy includes replication, select the **Destination system** and **Destination storage VM**. Select **Next**. 
. Select a backup destination or create a new one. Select **Next**. 
.. If your protection strategy includes user behavior detection, select a User activity agent in your environment to host the new data collectors. Ransomware Resilience creates the data collector automatically to transmit user activity events to Ransomware Resilience to detect anomalous user behavior.
. Review the new protection strategy then select **Protect** to apply it. 
. On the Protection page, review the **Detection status** to confirm detection is Active.  

=== Assign a different policy 

You can replace the existing policy with a different one. 

.Steps 


. From the Ransomware Resilience menu, select *Protection*.

. From the Protection page, on the workload row, select *Edit protection*. 


. If the workload has an existing Backup and Recovery policy that you want to maintain, uncheck **Replace existing policies**. To replace the existing policies, check **Replace existing policies**.  


. In the Policies page, select the down arrow for the policy you want to assign to review the details. 

. Select the policy you want to assign.
. Select *Protect* to complete the change.

== Manage ransomware protection strategies

You can delete a ransomware strategy.

=== View workloads protected by a ransomware protection strategy

Before you delete a ransomware protection strategy, you might want to view which workloads are protected by that strategy. 

You can view the workloads from the list of strategies or when you are editing a specific strategy. 

.Steps to view strategies

. From the Ransomware Resilience menu, select *Protection*.

. From the Protection page, select *Manage protection strategies*. 
+
The Ransomware protection strategies page displays a list of strategies.
+
image:screen-protection-strategy-list.png[Ransomware protection strategies screen showing a list of strategies] 
. On the Ransomware protection strategies page in the Protected workloads column, select the down arrow at the end of the row. 

//.Steps when editing a strategy


//. From the Ransomware Resilience menu, select *Protection*.

//. From the Protection page, select *Manage protection strategies*. 
//+
//image:screen-protection-strategy-list.png[Ransomware protection strategies screen showing the Actions menu]

//. In the Manage strategies page, select the *Actions* image:screenshot_horizontal_more_button.gif[Actions button] option for the strategy you want to change.

//. From the Actions menu, select *Edit*. 
//+
//image:screen-protection-strategy-edit.png[Edit ransomware protection strategy page]

//. View the workloads protected by this strategy by selecting *View* next to the number of workloads at the top of the page. 



//=== Edit a ransomware protection strategy 

//You can edit a protection strategy by selecting a different preconfigured detection policy strategy, selecting a different policy, or adding a new backup policy.

//.Steps 


//. From the Ransomware Resilience menu, select *Protection*.

//. From the Protection page, select *Manage protection strategies*. 
//+
//image:screen-protection-strategy-list.png[Ransomware protection strategies screen showing the Actions menu]

//. In the Manage strategies page, select the *Actions* image:screenshot_horizontal_more_button.gif[Actions button] option for the strategy you want to change.

//. From the Actions menu, select *Edit policy*. 

//. Do one of the following: 
//* Copy from an existing strategy. 
//* Select a different snapshot or backup policy.
//* Add a new snapshot or backup policy. 

//. Change the details. 

//. Select *Save* to finish the change. 

=== Delete a ransomware protection strategy

You can delete a protection strategy that is not currently associated with any workloads. 

.Steps 

. From the Ransomware Resilience menu, select *Protection*.

. From the Protection page, select *Manage protection strategies*. 

. In the Manage strategies page, select the *Actions* image:screenshot_horizontal_more_button.gif[Actions button] option for the strategy you want to delete.

. From the Actions menu, select *Delete policy*. 


