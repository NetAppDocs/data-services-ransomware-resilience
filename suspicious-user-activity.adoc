---
sidebar: sidebar
permalink: suspicious-user-activity.html
keywords: data breach detection, data breach, user activity, suspicious, anomalous, 
summary: Suspicious user activity detection in Ransomware Resilience enables you to detect user activity that could represent a potential threat. 
---
= Configure suspicious user activity detection in NetApp Ransomware Resilience
:hardbreaks:
:icons: font
:imagesdir: ./media/

[.lead]
Ransomware Resilience supports detection of suspicious user behavior in detection policies, enabling you to address ransomware incidents at the user-level. 

Ransomware Resilience detects suspicious user activity by analyzing user activity events generated by FPolicy in ONTAP. To collect user activity data, you need to deploy one or more user activity agents. The agent is a Linux server or VM with connectivity to devices on your tenant.

== Agents and collectors

At least one user activity agent must be installed to activate suspicious user activity detection in Ransomware Resilience. When you activate the suspicious user activity feature from the Ransomware Resilience dashboard, you need to provide the agent host information.

An agent can host multiple data collectors. Data collectors send data to a SaaS location for analysis. There are two types of collectors:

* The **data collector** collects user activity data from ONTAP.
* The **user directory connector** connects to your directory to map user IDs to usernames.

Collectors are configured in the Ransomware Resilience settings. 

== Enable suspicious user activity detection 

*Required Console role*
To activate suspicious user activity detection, you need the Organization admin role. For subsequent configurations for suspicious user activity, you need the Ransomware Resilience user behavior admin role. link:https://docs.netapp.com/us-en/console-setup-admin/reference-iam-ransomware-roles.html[Learn about Ransomware Resilience roles for NetApp Console^]. 

=== Add a user activity agent 

User activity agents are executable environments for data collectors; data collectors share user activity events with Ransomware Resilience. You must create at least one user activity agent to enable suspicious user activity detection.

==== Requirements 

To install a user activity agent, you need a host or VM that meets the following supported operating system and server requirements.

**Operating system requirements**

[%header,cols=2]
|===
| Operating system | Supported versions
| AlmaLinux |9.4 (64 bit) through 9.5 (64 bit), and 10 (64 bit), including SELinux
| CentOS | CentOS Stream 9 (64 bit)
| Debian | 11 (64 bit), 12 (64 bit), including SELinux
| OpenSUSE Leap | 15.3 (64 bit) through 15.6 (64 bit)
| Oracle Linux | 8.10 (64 bit), and 9.1 (64 bit) through 9.6 (64 bit), including SELinux
| Red Hat | 8.10 (64 bit), 9.1 (64 bit) through 9.6 (64 bit), and 10 (64 bit), including SELinux
| Rocky | Rocky 9.4 (64 bit) through 9.6 (64 bit), including SELinux
| SUSE Enterprise Linux |15 SP4 (64 bit) through 15 SP6 (64 bit), including SELinux
| Ubuntu | 20.04 LTS (64 bit), 22.04 LTS (64 bit) and 24.04 LTS (64 bit)
|===

**Server requirements**

The server must meet the following minimum requirements:

* **CPU**: 4 cores
* **RAM**: 16 GB RAM
* **Disk space**: 35 GB free disk space

**Cloud provider support**

Suspicious user activity data can be stored in AWS and Azure in the following regions:

[%header]
|===
| Cloud provider | Region 
| AWS 
a| 
* Asia Pacific (Sydney) (ap-southeast-2)
* Europe (Frankfurt) (eu-central-1)
* US East (N. Virginia) (us-east-1)
| Azure | East US
|===
 

.Steps

. If this is your first time creating a user activity agent, go to the **Dashboard**. In the **User activity** tile, select **Activate**.
+
If you're adding an additional user activity agent, go to *Settings*, locate the **User activity** tile, then select **Manage**. On the User activity screen, select the **User activity agents** tab then **Add**.
. Select a **Cloud provider** then a **Region**. Select **Next**. 
. Provide the user activity agent details:
  * **User activity agent name**
  * *Console agent* - the Console agent should be in the same network as the user activity agent and have SSH connectivity to the user activity agent IP address.
  * *VM DNS name or IP address* 
  * *VM SSH Key* 
+
image:user-activity-agent.png[Screenshot of add activity agent interface.]
. Select **Next**.
. Review your settings. Select *Activate* to complete adding the user activity agent. 
. Confirm the user activity agent was successfully created. In the User activity tile, a successful deployment displays as Running.

.Result
After the user activity agent is successfully created, return to the **Settings** menu then select **Manage** in the User activity tile. Select the **User activity agent** tab then select the user activity agent to view details about it, including data collectors and user directory connectors. 

=== Add a data collector 

Data collectors are created automatically when you enable a ransomware protection strategy with suspicious user activity detection. For more information, see xref:rp-use-protect.adoc#add-a-detection-policy-to-workloads-with-existing-snapshot-and-backup-policies-managed-by-snapcenter-or-backup-and-recovery[add a detection policy].

You can view the details of the data collector. From Settings, select **Manage** in the User activity tile. Select the **Data collector** tab then select the data collector to view its details or pause it.  

image:user-activity-settings.png[Screenshot of user activity settings]

=== Add a user directory connector

To map user IDs to usernames, you must create a user directory connector. 

.Steps 
. In Ransomware Resilience, go to *Settings*.
. In the User activity tile, select **Manage**.
. Select the **User directory connectors** tab then **Add**.
. Configure the connection. Enter the required information for each field.
+
|===
| Field | Description 
| *Name* | Enter a unique name for the user directory connector
| *User directory type* | The directory type
| *Server IP address or domain name* | The IP address or Fully-Qualified Domain Name (FQDN) of the server hosting the connection 
| *Forest name or search name* 
a| 	You can specify the forest level of the directory structure as the direct domain name (for example `unit.company.com`) or a set of relative distinguished names (for example: `DC=unit,DC=company,DC=com`). You can also enter an `OU` to filter by an organizational unit or a `CN` to limit to a specific user (for example: `CN=user,OU=engineering,DC=unit,DC=company,DC=com`).
| *BIND DN* | The BIND DN is a user account permitted to search the directory, such as user@domain.com. The user requires the Domain Read Only permission. 
| *BIND password* | The password for the user provided in BIND DN
| *Protocol* | The protocol field is optional. You can use LDAP, LDAPS, or LDAP over StartTLS.
| *Port* | Enter your chosen port number
|===
+
image:screenshot-user-directory-connection.png[Screenshot of user directory connection]
+
Provide the attribute mapping details:
+
* *Display name*
* *SID* (if you're using LDAP)
* *User name* 
* *Unix ID* (if you're using NFS)
* If you select *Include optional attributes*, you can also add an email address, telephone number, role, state, country, department, photo, manager DN, or groups. 
+
Select *Advanced* to add an optional search query. 
. Select **Add**. 
. Return to the user directory connectors tab to check the status of your user directory connector. If created successfully, the status of the user directory connector displays as *Running*. 

=== Delete a user directory connector

. In Ransomware Resilience, go to *Settings*.
. Locate the User activity tile, select **Manage**.
. Select the **User directory connector** tab.
. Identify the user directory connector you want to delete. In the action menu at the end of the line, select the three dots `...` then **Delete**.
. In the pop-up dialog, select **Delete** to confirm your actions. 

// === Delete a user activity agent

// . In Ransomware Resilience, go to *Settings*.
// . Locate the User activity tile, select **Manage**.
// . Select the **User activity agent** tab.
// . Identify the user activity agent you want to delete. In the action menu at the end of the line, select the three dots `...` then **Delete**.
// . In the pop-up dialog, select **Delete** to confirm your actions. 


== Respond to suspicious user activity alerts

After you configure suspicious user activity detection, you can monitor events in the alerts page. For more information, see link:rp-use-alert.html#detect-malicious-activity-and-anomalous-user-behavior[Detect malicious activity and anomalous user behavior].